# スペースマーケット お気に入り収集ツール - Webアプリ版

スペースマーケットのお気に入りデータを自動収集してExcelファイルに出力するWebアプリケーションです。

## ✨ 特徴

- ✅ **ブラウザで操作** - モダンなWeb UI
- ✅ **完全自動化** - ログインから収集まで全自動
- ✅ **クロスプラットフォーム** - Windows/Mac/Linux 対応
- ✅ **操作が見える** - ブラウザウィンドウで動作確認可能
- ✅ **ボタン1つで実行** - 技術知識不要
- ✅ **リアルタイム進捗表示** - 処理状況をリアルタイムで確認

---

## 📋 必要な環境

- **Python 3.8以上**
- **Google Chrome** または **Chromium**
- **インターネット接続**

---

## 🚀 インストール方法

### Windows の場合

1. **このフォルダ全体を任意の場所に保存**
   - 例: デスクトップ、ドキュメントなど

2. **Pythonをインストール**（未インストールの場合）
   - https://www.python.org/downloads/
   - インストール時に「Add Python to PATH」にチェック✅

3. **セットアップを実行**
   - `setup.bat` をダブルクリック
   - 必要なパッケージが自動でインストールされます

### Mac の場合

1. **このフォルダ全体を任意の場所に保存**

2. **Pythonをインストール**（未インストールの場合）
   ```bash
   brew install python3
   ```

3. **セットアップを実行**
   ```bash
   bash setup.sh
   ```
   または
   ```bash
   chmod +x setup.sh
   ./setup.sh
   ```

### Linux の場合

1. **このフォルダ全体を任意の場所に保存**

2. **Pythonとpipをインストール**
   ```bash
   sudo apt-get update
   sudo apt-get install python3 python3-pip
   ```

3. **セットアップを実行**
   ```bash
   bash setup.sh
   ```

---

## 📖 使い方

### 起動方法

#### Windows
1. `start.bat` をダブルクリック
2. 自動でブラウザが開きます

#### Mac / Linux
1. ターミナルで以下を実行:
   ```bash
   bash start.sh
   ```
   または
   ```bash
   ./start.sh
   ```
2. 自動でブラウザが開きます

#### ブラウザが開かない場合
手動でブラウザを開いて以下のURLにアクセス:
```
http://localhost:8080
```

---

### 操作手順

1. **ログイン情報を入力**
   - メールアドレス
   - パスワード

2. **実行オプションを選択**（任意）
   - ☑️ バックグラウンドで実行
     - チェックを入れる: ブラウザウィンドウを表示しない（高速）
     - チェックなし: ブラウザウィンドウで操作が見える（推奨）

3. **「お気に入りを収集する」ボタンをクリック**

4. **自動実行**
   - ブラウザが自動で開く（非表示モードでない場合）
   - スペースマーケットにログイン
   - お気に入りページに移動
   - データを自動収集
   - 進捗がリアルタイムで表示されます

5. **ダウンロード**
   - 完了したら「Excelファイルをダウンロード」ボタンが表示
   - クリックしてExcelファイルを保存

---

## 📊 収集されるデータ

Excelファイルには以下の情報が含まれます：

| 列名 | 内容 |
|------|------|
| スペース名 | レンタルスペースの名称 |
| 価格 | 1時間あたりの料金 |
| レビュー点数 | ユーザー評価スコア |
| 所在地 | スペースの所在地・駅情報 |
| カテゴリ | スペースのカテゴリ |
| URL | 詳細ページのURL |
| 画像URL | サムネイル画像のURL |

---

## 🎨 画面説明

### メイン画面
```
┌─────────────────────────────────────┐
│  スペースマーケット お気に入り収集  │
├─────────────────────────────────────┤
│                                     │
│  メールアドレス: [______________]   │
│  パスワード:     [______________]   │
│                                     │
│  ☐ バックグラウンドで実行          │
│                                     │
│  ┌──────────────────────────┐      │
│  │  お気に入りを収集する  │      │
│  └──────────────────────────┘      │
│                                     │
│  状態: ログイン中...                │
│  ━━━━━━━━━━━━ 45%                 │
│                                     │
└─────────────────────────────────────┘
```

### 完了画面
```
┌─────────────────────────────────────┐
│  ✅ 完了！15件のデータを収集        │
│                                     │
│  ┌──────────────────────────┐      │
│  │ Excelファイルをダウンロード│    │
│  └──────────────────────────┘      │
└─────────────────────────────────────┘
```

---

## 🔧 トラブルシューティング

### Q1: ブラウザが起動しない

**原因:**
- Google Chromeがインストールされていない
- ChromeDriverのダウンロードに失敗

**解決方法:**
1. Google Chromeをインストール
   - https://www.google.com/chrome/
2. インターネット接続を確認
3. 再度実行

---

### Q2: ログインに失敗する

**原因:**
- メールアドレスまたはパスワードが間違っている
- スペースマーケット側のログインページ仕様変更

**解決方法:**
1. ログイン情報を再確認
2. スペースマーケットのWebサイトで手動ログインできるか確認
3. 2段階認証が有効な場合は無効化を検討

---

### Q3: データが収集されない

**原因:**
- お気に入りが0件
- ページ構造が変更された

**解決方法:**
1. スペースマーケットのWebサイトでお気に入りがあるか確認
2. ブラウザ表示モード（非バックグラウンド）で実行して確認
3. ターミナル/コマンドプロンプトのエラーメッセージを確認

---

### Q4: エラーメッセージが表示される

**原因:**
- 必要なパッケージがインストールされていない
- Pythonのバージョンが古い

**解決方法:**
1. セットアップを再実行
   ```bash
   # Windows
   setup.bat
   
   # Mac/Linux
   bash setup.sh
   ```
2. Pythonのバージョンを確認
   ```bash
   python --version  # Windows
   python3 --version # Mac/Linux
   ```
   - Python 3.8以上が必要

---

### Q5: ポート5000が使用中

**エラー:**
```
Address already in use
```

**解決方法:**

#### 方法1: ポートを変更
`app.py` の最後の行を編集:
```python
# 変更前
app.run(debug=True, host='0.0.0.0', port=8080)

# 変更後（例: 8080に変更）
app.run(debug=True, host='0.0.0.0', port=8080)
```

その後、ブラウザで `http://localhost:8080` を開く

#### 方法2: 使用中のプロセスを終了（Windows）
```cmd
netstat -ano | findstr :8080
taskkill /PID <PID番号> /F
```

#### 方法2: 使用中のプロセスを終了（Mac/Linux）
```bash
lsof -ti:8080 | xargs kill -9
```

---

## 🛡️ セキュリティについて

### ログイン情報の扱い

- **保存されません**: 入力したログイン情報はメモリ上でのみ使用され、ファイルには保存されません
- **セッション終了時に削除**: アプリを終了すると全て削除されます
- **ローカル実行**: インターネットには送信されず、全てローカルPCで処理されます

### 推奨事項

- **公共のPCでは使用しない**
- **信頼できるネットワークで実行**
- **定期的にパスワードを変更**

---

## 📁 フォルダ構成

```
spacemarket-webapp/
├── app.py                    # メインアプリケーション
├── templates/
│   └── index.html           # Webページ
├── static/                  # ダウンロードファイル保存先
│   └── (自動生成)
├── requirements.txt         # 必要なパッケージ
├── setup.bat                # Windowsセットアップ
├── setup.sh                 # Mac/Linuxセットアップ
├── start.bat                # Windows起動
├── start.sh                 # Mac/Linux起動
└── README.md                # このファイル
```

---

## 🔄 更新履歴

### v1.0.0 (2026-01-22)
- ✅ 初回リリース
- ✅ Webアプリ版
- ✅ Windows/Mac/Linux対応
- ✅ リアルタイム進捗表示
- ✅ バックグラウンド実行オプション

---

## 💡 よくある質問

### Q: 何件まで収集できますか？
A: お気に入りページに表示されている全てのスペースを収集できます。

### Q: 定期実行できますか？
A: 現バージョンでは手動実行のみです。定期実行機能は将来のバージョンで実装予定です。

### Q: 複数のアカウントで実行できますか？
A: はい。ログイン情報を変えて何度でも実行できます。

### Q: Excelファイルはどこに保存されますか？
A: `static/` フォルダに保存されます。ダウンロードボタンでブラウザのダウンロードフォルダにも保存できます。

### Q: スペースマーケット以外にも使えますか？
A: 現在はスペースマーケット専用です。他サイト対応は将来検討します。

---

## 📞 サポート

### エラーが発生した場合

1. **ターミナル/コマンドプロンプトのログを確認**
   - 詳細なエラーメッセージが表示されます

2. **ブラウザのコンソールを確認**
   - F12キーを押してDeveloper Toolsを開く
   - Consoleタブでエラーを確認

3. **セットアップを再実行**
   ```bash
   # Windows
   setup.bat
   
   # Mac/Linux
   bash setup.sh
   ```

---

## ⚠️ 注意事項

- この スクリプトは個人利用を目的としています
- スペースマーケットの利用規約を遵守してください
- 過度なアクセスはサーバーに負荷をかける可能性があります
- 収集したデータの取り扱いには十分注意してください
- 自己責任でご利用ください

---

## 📜 ライセンス

個人利用のみ許可されています。

---

**開発日**: 2026年1月22日  
**バージョン**: 1.0.0  
**対応OS**: Windows 10/11, macOS 10.15+, Ubuntu 20.04+
